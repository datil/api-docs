<h1 id="withholdings">Withholdings</h1>

<h2 id="issuing-a-withholding">Issuing a withholding</h2>

<h3 id="operation">Operation</h3>

<p><code class="prettyprint">POST /retentions/issue</code></p>

<h3 id="requirement">Requirement</h3>

<blockquote>
<h4 id="example-requirement">Example requirement</h4>
</blockquote>
<pre class="highlight shell"><code>curl -v https://link.datil.co/retentions/issue <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
-H <span class="s2">"X-Key: &lt;your-api-key&gt;"</span> <span class="se">\</span>
-H <span class="s2">"X-Password: &lt;your-certificate-password&gt;"</span> <span class="se">\</span>
-d <span class="s1">'{
  "ambiente":1,
  "tipo_emision":1,
  "secuencial":14,
  "fecha_emision":"2015-12-25T11:28:56.782Z",
  "periodo_fiscal":"12/2015",
  "emisor":{
    "ruc":"0910000000001",
    "obligado_contabilidad":true,
    "contribuyente_especial":"12345",
    "nombre_comercial":"XYZ Corp",
    "razon_social":"XYZ Corporación S.A.",
    "direccion":"Av. Primera 234 y calle 5ta",
    "establecimiento":{
      "punto_emision":"002",
      "codigo":"001",
      "direccion":"Av. Primera 234 y calle 5ta"
    }
  },
  "informacion_adicional":{
    "Envíada al correo electónico":"contabilidad@xyz.com"
  },
  "items":[
    {
      "base_imponible": 4226.4,
      "codigo": 1,
      "codigo_porcentaje": "312",
      "fecha_emision_documento_sustento": "2015-12-04T00:00:00-05:19",
      "numero_documento_sustento": "011-007-000000251",
      "porcentaje": 1.0,
      "tipo_documento_sustento": "01",
      "valor_retenido": 42.26
    }
  ]
  "sujeto":{
    "email":"contabilidad@email.com",
    "identificacion":"0987654321",
    "tipo_identificacion":"05",
    "razon_social":"Juan Pérez",
    "direccion":"Calle única Numero 987",
    "telefono":"046029400"
  }
}'</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">json</span>

<span class="n">retencion</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">"ambiente"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
  <span class="s">"tipo_emision"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
  <span class="s">"secuencial"</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span>
  <span class="s">"fecha_emision"</span><span class="p">:</span><span class="s">"2015-12-25T11:28:56.782Z"</span><span class="p">,</span>
  <span class="s">"periodo_fiscal"</span><span class="p">:</span><span class="s">"12/2015"</span><span class="p">,</span>
  <span class="s">"emisor"</span><span class="p">:{</span>
    <span class="s">"ruc"</span><span class="p">:</span><span class="s">"0910000000001"</span><span class="p">,</span>
    <span class="s">"obligado_contabilidad"</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
    <span class="s">"contribuyente_especial"</span><span class="p">:</span><span class="s">"12345"</span><span class="p">,</span>
    <span class="s">"nombre_comercial"</span><span class="p">:</span><span class="s">"XYZ Corp"</span><span class="p">,</span>
    <span class="s">"razon_social"</span><span class="p">:</span><span class="s">"XYZ Corporación S.A."</span><span class="p">,</span>
    <span class="s">"direccion"</span><span class="p">:</span><span class="s">"Av. Primera 234 y calle 5ta"</span><span class="p">,</span>
    <span class="s">"establecimiento"</span><span class="p">:{</span>
      <span class="s">"punto_emision"</span><span class="p">:</span><span class="s">"002"</span><span class="p">,</span>
      <span class="s">"codigo"</span><span class="p">:</span><span class="s">"001"</span><span class="p">,</span>
      <span class="s">"direccion"</span><span class="p">:</span><span class="s">"Av. Primera 234 y calle 5ta"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s">"informacion_adicional"</span><span class="p">:{</span>
    <span class="s">"Envíada al correo electónico"</span><span class="p">:</span><span class="s">"contabilidad@xyz.com"</span>
  <span class="p">},</span>
  <span class="s">"items"</span><span class="p">:[</span>
    <span class="p">{</span>
      <span class="s">"base_imponible"</span><span class="p">:</span> <span class="mf">4226.4</span><span class="p">,</span>
      <span class="s">"codigo"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s">"codigo_porcentaje"</span><span class="p">:</span> <span class="s">"312"</span><span class="p">,</span>
      <span class="s">"fecha_emision_documento_sustento"</span><span class="p">:</span> <span class="s">"2015-12-04T00:00:00-05:19"</span><span class="p">,</span>
      <span class="s">"numero_documento_sustento"</span><span class="p">:</span> <span class="s">"011-007-000000251"</span><span class="p">,</span>
      <span class="s">"porcentaje"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
      <span class="s">"tipo_documento_sustento"</span><span class="p">:</span> <span class="s">"01"</span><span class="p">,</span>
      <span class="s">"valor_retenido"</span><span class="p">:</span> <span class="mf">42.26</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s">"sujeto"</span><span class="p">:{</span>
    <span class="s">"email"</span><span class="p">:</span><span class="s">"contabilidad@email.com"</span><span class="p">,</span>
    <span class="s">"identificacion"</span><span class="p">:</span><span class="s">"0987654321"</span><span class="p">,</span>
    <span class="s">"tipo_identificacion"</span><span class="p">:</span><span class="s">"05"</span><span class="p">,</span>
    <span class="s">"razon_social"</span><span class="p">:</span><span class="s">"Juan Pérez"</span><span class="p">,</span>
    <span class="s">"direccion"</span><span class="p">:</span><span class="s">"Calle única Numero 987"</span><span class="p">,</span>
    <span class="s">"telefono"</span><span class="p">:</span><span class="s">"046029400"</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="n">cabeceras</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'x-key'</span><span class="p">:</span> <span class="s">'&lt;clave-del-api&gt;'</span><span class="p">,</span>
    <span class="s">'x-password'</span><span class="p">:</span> <span class="s">'&lt;your-certificate-password&gt;'</span><span class="p">,</span>
    <span class="s">'content-type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">}</span>
<span class="n">respuesta</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="s">"https://link.datil.co/retentions/issue"</span><span class="p">,</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">cabeceras</span><span class="p">,</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">retencion</span><span class="p">))</span>
</code></pre>
<pre class="highlight csharp"><code><span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">DatilClient</span> <span class="p">{</span>
  <span class="k">class</span> <span class="nc">InvoicingServiceClient</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// Este ejemplo utiliza RestSharp
</span>      <span class="c1">// Para instalar anda al menú: tools &gt; Library Package Manager &gt; Package Manager Console
</span>      <span class="c1">// copia y pega y presiona enter: Install-Package RestSharp
</span>
      <span class="n">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RestClient</span><span class="p">(</span><span class="s">"https://link.datil.co/"</span><span class="p">);</span>
      <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RestRequest</span><span class="p">(</span><span class="s">"invoices/issue"</span><span class="p">,</span> <span class="n">Method</span><span class="p">.</span><span class="n">POST</span><span class="p">);</span>
      <span class="n">request</span><span class="p">.</span><span class="nf">AddHeader</span><span class="p">(</span><span class="s">"X-Key"</span><span class="p">,</span> <span class="s">"&lt;clave-del-api&gt;"</span><span class="p">);</span>
      <span class="n">request</span><span class="p">.</span><span class="nf">AddHeader</span><span class="p">(</span><span class="s">"X-Password"</span><span class="p">,</span> <span class="s">"&lt;your-certificate-password&gt;"</span><span class="p">);</span>

      <span class="n">request</span><span class="p">.</span><span class="nf">AddBody</span><span class="p">(</span><span class="err">@</span><span class="s">"{
</span>        <span class="s">""</span><span class="n">ambiente</span><span class="s">""</span><span class="p">:</span><span class="m">1</span><span class="p">,</span>
        <span class="s">""</span><span class="n">tipo_emision</span><span class="s">""</span><span class="p">:</span><span class="m">1</span><span class="p">,</span>
        <span class="s">""</span><span class="n">secuencial</span><span class="s">""</span><span class="p">:</span><span class="m">14</span><span class="p">,</span>
        <span class="s">""</span><span class="n">fecha_emision</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">2015</span><span class="p">-</span><span class="m">12</span><span class="p">-</span><span class="m">25</span><span class="n">T11</span><span class="p">:</span><span class="m">28</span><span class="p">:</span><span class="m">56.782</span><span class="n">Z</span><span class="s">""</span><span class="p">,</span>
        <span class="s">""</span><span class="n">periodo_fiscal</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">12</span><span class="p">/</span><span class="m">2015</span><span class="s">""</span><span class="p">,</span>
        <span class="s">""</span><span class="n">emisor</span><span class="s">""</span><span class="p">:{</span>
          <span class="s">""</span><span class="n">ruc</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">0910000000001</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">obligado_contabilidad</span><span class="s">""</span><span class="p">:</span><span class="k">true</span><span class="p">,</span>
          <span class="s">""</span><span class="n">contribuyente_especial</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">12345</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">nombre_comercial</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">XYZ</span> <span class="n">Corp</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">razon_social</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">XYZ</span> <span class="n">Corporaci</span><span class="err">ó</span><span class="n">n</span> <span class="n">S</span><span class="p">.</span><span class="n">A</span><span class="p">.</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">direccion</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">Av</span><span class="p">.</span> <span class="n">Primera</span> <span class="m">234</span> <span class="n">y</span> <span class="n">calle</span> <span class="m">5</span><span class="n">ta</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">establecimiento</span><span class="s">""</span><span class="p">:{</span>
            <span class="s">""</span><span class="n">punto_emision</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">002</span><span class="s">""</span><span class="p">,</span>
            <span class="s">""</span><span class="n">codigo</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">001</span><span class="s">""</span><span class="p">,</span>
            <span class="s">""</span><span class="n">direccion</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">Av</span><span class="p">.</span> <span class="n">Primera</span> <span class="m">234</span> <span class="n">y</span> <span class="n">calle</span> <span class="m">5</span><span class="n">ta</span><span class="s">""</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s">""</span><span class="n">informacion_adicional</span><span class="s">""</span><span class="p">:{</span>
          <span class="s">""</span><span class="n">Env</span><span class="err">í</span><span class="n">ada</span> <span class="n">al</span> <span class="n">correo</span> <span class="n">elect</span><span class="err">ó</span><span class="n">nico</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">contabilidad@xyz</span><span class="p">.</span><span class="n">com</span><span class="s">""</span>
        <span class="p">},</span>
        <span class="s">""</span><span class="n">items</span><span class="s">""</span><span class="p">:[</span>
          <span class="p">{</span>
            <span class="s">""</span><span class="n">base_imponible</span><span class="s">""</span><span class="p">:</span> <span class="m">4226.4</span><span class="p">,</span>
            <span class="s">""</span><span class="n">codigo</span><span class="s">""</span><span class="p">:</span> <span class="m">1</span><span class="p">,</span>
            <span class="s">""</span><span class="n">codigo_porcentaje</span><span class="s">""</span><span class="p">:</span> <span class="s">""</span><span class="m">312</span><span class="s">""</span><span class="p">,</span>
            <span class="s">""</span><span class="n">fecha_emision_documento_sustento</span><span class="s">""</span><span class="p">:</span> <span class="s">""</span><span class="m">2015</span><span class="p">-</span><span class="m">12</span><span class="p">-</span><span class="m">04</span><span class="n">T00</span><span class="p">:</span><span class="m">00</span><span class="p">:</span><span class="m">00</span><span class="p">-</span><span class="m">05</span><span class="p">:</span><span class="m">19</span><span class="s">""</span><span class="p">,</span>
            <span class="s">""</span><span class="n">numero_documento_sustento</span><span class="s">""</span><span class="p">:</span> <span class="s">""</span><span class="m">011007000000251</span><span class="s">""</span><span class="p">,</span>
            <span class="s">""</span><span class="n">porcentaje</span><span class="s">""</span><span class="p">:</span> <span class="m">1.0</span><span class="p">,</span>
            <span class="s">""</span><span class="n">tipo_documento_sustento</span><span class="s">""</span><span class="p">:</span> <span class="s">""</span><span class="m">01</span><span class="s">""</span><span class="p">,</span>
            <span class="s">""</span><span class="n">valor_retenido</span><span class="s">""</span><span class="p">:</span> <span class="m">42.26</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s">""</span><span class="n">sujeto</span><span class="s">""</span><span class="p">:{</span>
          <span class="s">""</span><span class="n">email</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">contabilidad@email</span><span class="p">.</span><span class="n">com</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">identificacion</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">0987654321</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">tipo_identificacion</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">05</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">razon_social</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">Juan</span> <span class="n">P</span><span class="err">é</span><span class="n">rez</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">direccion</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="n">Calle</span> <span class="err">ú</span><span class="n">nica</span> <span class="n">Numero</span> <span class="m">987</span><span class="s">""</span><span class="p">,</span>
          <span class="s">""</span><span class="n">telefono</span><span class="s">""</span><span class="p">:</span><span class="s">""</span><span class="m">046029400</span><span class="s">""</span>
        <span class="p">}</span>
      <span class="p">}</span><span class="s">");
</span>
      <span class="n">IRestResponse</span> <span class="n">response</span> <span class="p">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>

      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">);</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>A withholding requires the following information</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>secuencial</td>
<td>string</td>
<td>Withholding sequence number. <strong>Required</strong></td>
</tr>
<tr>
<td>emisor</td>
<td><a href="#issuer">issuer</a></td>
<td>Information about the issuer.  <strong>Required</strong></td>
</tr>
<tr>
<td>fecha_emision</td>
<td>string</td>
<td>Issuance date in <a href="http://tools.ietf.org/html/rfc3339#section-5.6">ISO8601</a> format (AAAA-MM-DDHourTimeZone).</td>
</tr>
<tr>
<td>periodo_fiscal</td>
<td>string</td>
<td>Month and year in MM/YYYY fomat.</td>
</tr>
<tr>
<td>ambiente</td>
<td>integer</td>
<td>Environment. Test: <code class="prettyprint">1</code>.<br>Production <code class="prettyprint">2</code>.<br><strong>Required</strong></td>
</tr>
<tr>
<td>impuestos</td>
<td>list of <a href="#withholded-tax">withholded-tax</a> objects</td>
<td>List of withholded tax line items. <strong>Required</strong></td>
</tr>
<tr>
<td>tipo_emision</td>
<td>integer</td>
<td>Issuance mode. Normal: <code class="prettyprint">1</code>.<br>Contingency: <code class="prettyprint">2</code><br><strong>Required</strong></td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>Version of the country e-billing format. Defaults to the latest version.</td>
</tr>
<tr>
<td>clave_acceso</td>
<td>string</td>
<td>The access code represents a unique identified for the document. Datil will generate an access code if you don&rsquo;t provide it.<br>¿How to <a href="#access-code">generate</a> an access code?</td>
</tr>
<tr>
<td>informacion_adicional</td>
<td>object</td>
<td>Additional information about the invoice in dictionary form. Example:<br><code class="prettyprint">{&quot;plan&quot;: &quot;pro&quot;, &quot;months&quot;: &quot;1&quot;}</code></td>
</tr>
</tbody></table>

<h4 id="withholded-tax">Withholded tax</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>base_imponible</td>
<td>float</td>
<td>Taxable amount with up to 2 decimals. <strong>Required</strong></td>
</tr>
<tr>
<td>codigo</td>
<td>string</td>
<td><a href="#withholding-tax-types">withholding-tax-type</a> code. <strong>Required</strong></td>
</tr>
<tr>
<td>codigo_porcentaje</td>
<td>string</td>
<td>Tax rate code. <strong>Required</strong></td>
</tr>
<tr>
<td>porcentaje</td>
<td>float</td>
<td>Tax rate.</td>
</tr>
<tr>
<td>valor_retenido</td>
<td>float</td>
<td>Withholded tax amount, calculated from the product of <code class="prettyprint">porcentaje</code> and <code class="prettyprint">base_imponible</code>, with up to 2 decimals.  <strong>Required</strong></td>
</tr>
<tr>
<td>fecha_emision_documento_sustento</td>
<td>string</td>
<td>Issuance date in <a href="http://tools.ietf.org/html/rfc3339#section-5.6">ISO8601</a> format (AAAA-MM-DDHourTimeZone). <strong>Required</strong></td>
</tr>
<tr>
<td>numero_documento_sustento</td>
<td>string</td>
<td>Complete document number of the e-document being modified. Normally invoices. Example: 001-002-010023098 <strong>Required</strong></td>
</tr>
</tbody></table>

<h3 id="response">Response</h3>

<blockquote>
<h4 id="example-response">Example response</h4>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcdef09876123cea56784f01"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"clave_acceso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2802201501091000000000120010010000100451993736618"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ambiente"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tipo_emision"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"secuencial"</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fecha_emision"</span><span class="p">:</span><span class="s2">"2015-12-25T11:28:56.782Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"periodo_fiscal"</span><span class="p">:</span><span class="s2">"12/2015"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"emisor"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"ruc"</span><span class="p">:</span><span class="s2">"0910000000001"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"obligado_contabilidad"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"contribuyente_especial"</span><span class="p">:</span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"nombre_comercial"</span><span class="p">:</span><span class="s2">"XYZ Corp"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"razon_social"</span><span class="p">:</span><span class="s2">"XYZ Corporación S.A."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"direccion"</span><span class="p">:</span><span class="s2">"Av. Primera 234 y calle 5ta"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"establecimiento"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"punto_emision"</span><span class="p">:</span><span class="s2">"002"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"codigo"</span><span class="p">:</span><span class="s2">"001"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"direccion"</span><span class="p">:</span><span class="s2">"Av. Primera 234 y calle 5ta"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"informacion_adicional"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"Envíada al correo electónico"</span><span class="p">:</span><span class="s2">"contabilidad@xyz.com"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"items"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"base_imponible"</span><span class="p">:</span><span class="w"> </span><span class="mf">4226.4</span><span class="p">,</span><span class="w">
      </span><span class="nt">"codigo"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"codigo_porcentaje"</span><span class="p">:</span><span class="w"> </span><span class="s2">"312"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"fecha_emision_documento_sustento"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T00:00:00-05:19"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"numero_documento_sustento"</span><span class="p">:</span><span class="w"> </span><span class="s2">"011-007-000000251"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"porcentaje"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tipo_documento_sustento"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"valor_retenido"</span><span class="p">:</span><span class="w"> </span><span class="mf">42.26</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"sujeto"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"contabilidad@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"identificacion"</span><span class="p">:</span><span class="s2">"0987654321"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tipo_identificacion"</span><span class="p">:</span><span class="s2">"05"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"razon_social"</span><span class="p">:</span><span class="s2">"Juan Pérez"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"direccion"</span><span class="p">:</span><span class="s2">"Calle única Numero 987"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"telefono"</span><span class="p">:</span><span class="s2">"046029400"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Returns a <strong><a href="#withholding-request">withholding</a></strong> object that includes an <code class="prettyprint">id</code> parameter that uniquely identifies the withholding. A generated access code is included as <code class="prettyprint">clave_acceso</code>.</p>

<h2 id="querying-a-withholding">Querying a withholding</h2>

<p>You can query the API for the status of a withholding and look for the <code class="prettyprint">estado</code> parameter. This will tell you if the e-document is authorized or not.</p>

<p>If you want to know the specific step the withholding is into the <a href="#issuance-process">issuance process</a>, look for value in <code class="prettyprint">envio_sri</code> and <code class="prettyprint">autorizacion_sri</code>.</p>

<h3 id="operation">Operation</h3>

<p><code class="prettyprint">GET /retentions/&lt;receipt-id&gt;</code></p>

<h3 id="request">Request</h3>

<blockquote>
<h4 id="example-request">Example request</h4>
</blockquote>
<pre class="highlight shell"><code>curl -v https://link.datil.co/retentions/&lt;id-retencion&gt; <span class="se">\</span>
-H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
-H <span class="s2">"X-Key: &lt;clave-del-api&gt;"</span> <span class="se">\</span>
-H <span class="s2">"X-Password: &lt;your-certificate-password&gt;"</span> <span class="se">\</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">cabeceras</span> <span class="o">=</span> <span class="p">{</span><span class="s">'x-key'</span><span class="p">:</span> <span class="s">'&lt;clave-del-api&gt;'</span><span class="p">}</span>
<span class="n">respuesta</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s">'https://link.datil.co/retentions/&lt;id-retencion&gt;'</span><span class="p">,</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">cabeceras</span><span class="p">)</span>
</code></pre>
<pre class="highlight csharp"><code><span class="k">using</span> <span class="nn">RestSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">DatilClient</span> <span class="p">{</span>
  <span class="k">class</span> <span class="nc">InvoicingServiceClient</span> <span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>

      <span class="n">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RestClient</span><span class="p">(</span><span class="s">"https://link.datil.co/"</span><span class="p">);</span>
      <span class="n">var</span> <span class="n">idNotaCredito</span> <span class="p">=</span> <span class="s">"&lt;id-retencion&gt;"</span><span class="p">;</span>
      <span class="n">var</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RestRequest</span><span class="p">(</span><span class="s">"invoices/"</span> <span class="p">+</span> <span class="n">idNotaCredito</span><span class="p">,</span> <span class="n">Method</span><span class="p">.</span><span class="n">GET</span><span class="p">);</span>
      <span class="n">request</span><span class="p">.</span><span class="nf">AddHeader</span><span class="p">(</span><span class="s">"X-Key"</span><span class="p">,</span> <span class="s">"&lt;clave-del-api&gt;"</span><span class="p">);</span>

      <span class="n">IRestResponse</span> <span class="n">response</span> <span class="p">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>

      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Replace <code class="prettyprint">&lt;invoice-ID&gt;</code> for the <code class="prettyprint">id</code> of the withholding you want to query.</p>

<h3 id="response">Response</h3>

<blockquote>
<h4 id="example-response">Example response</h4>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcf12343faad06785abcf12343faad0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"secuencial"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fecha_emision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-05-15"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"clave_acceso"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1505201501099271255400110011000000000162092727615"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"emisor"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"ruc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0992712554001"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"razon_social"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DATILMEDIA S.A."</span><span class="p">,</span><span class="w">
        </span><span class="nt">"nombre_comercial"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dátil"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"direccion"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"obligado_contabilidad"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"contribuyente_especial"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"establecimiento"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"codigo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"direccion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"V.E. 112 Y CIRCUNVALACION NORTE"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"punto_emision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"estado"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AUTORIZADO"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"items"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"base_imponible"</span><span class="p">:</span><span class="w"> </span><span class="mf">4226.4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"codigo"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"codigo_porcentaje"</span><span class="p">:</span><span class="w"> </span><span class="s2">"312"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"fecha_emision_documento_sustento"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T00:00:00-05:19"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"numero_documento_sustento"</span><span class="p">:</span><span class="w"> </span><span class="s2">"011007000000251"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"porcentaje"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"tipo_documento_sustento"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"valor_retenido"</span><span class="p">:</span><span class="w"> </span><span class="mf">42.26</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"correos_enviados"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"fecha_envio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-05-15T16:36:48.274604"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"destinatarios"</span><span class="p">:</span><span class="w"> </span><span class="s2">"juanantonioplaza@datilmedia.com"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"informacion_adicional"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"ambiente"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sujeto"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"razon_social"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Carlos L. Plaza"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"identificacion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0900102222"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"tipo_identificacion"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cplaza@gye593.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"direccion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Calle Uno y Calle Dos"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"telefono"</span><span class="p">:</span><span class="w"> </span><span class="s2">"043334445"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"envio_sri"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mensajes"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="nt">"estado"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RECIBIDA"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"fecha"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"tipo_emision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"autorizacion"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"estado"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AUTORIZADO"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"mensajes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nt">"identificador"</span><span class="p">:</span><span class="w"> </span><span class="s2">"60"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"mensaje"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ESTE PROCESO FUE REALIZADO EN EL AMBIENTE DE PRUEBAS"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"tipo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INFORMATIVO"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"informacion_adicional"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nt">"numero"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1505201516323509927125540010266935227"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"fecha"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-05-15T16:32:35.000380"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>secuencial</td>
<td>string</td>
<td>Withholding sequence number.</td>
</tr>
<tr>
<td>estado</td>
<td>string</td>
<td>Possible values: <code class="prettyprint">AUTORIZADO</code> (authorized), <code class="prettyprint">NO AUTORIZADO</code> (not authorized), <code class="prettyprint">ENVIADO</code> (sent), <code class="prettyprint">DEVUELTO</code> (rejected), <code class="prettyprint">RECIBIDO</code> (received).</td>
</tr>
<tr>
<td>fecha_emision</td>
<td>string</td>
<td>Issuance date in <a href="http://tools.ietf.org/html/rfc3339#section-5.6">ISO8601</a> format (AAAA-MM-DDHourTimeZone).</td>
</tr>
<tr>
<td>clave_acceso</td>
<td>string</td>
<td>The access code represents a unique identified for the document. Datil will generate an access code if you don&rsquo;t provide it.<br>¿How to <a href="#access-code">generate</a> an access code?</td>
</tr>
<tr>
<td>envio_sri</td>
<td><a href="#sri-sending">sri-sending</a> object</td>
<td>Information about the sending step.</td>
</tr>
<tr>
<td>autorizacion</td>
<td><a href="#sri-authorization">sri-authorization</a> object</td>
<td>Information about the authorization step.</td>
</tr>
<tr>
<td>emisor</td>
<td><a href="#issuer">issuer</a></td>
<td>Information about the issuer.</td>
</tr>
<tr>
<td>ambiente</td>
<td>integer</td>
<td>Environment: Test <code class="prettyprint">1</code>.<br>Production <code class="prettyprint">2</code>.<br></td>
</tr>
<tr>
<td>items</td>
<td>list of <a href="#withholded-tax">withholded tax</a> objects</td>
<td>List of withholded taxes. <strong>Required</strong></td>
</tr>
<tr>
<td>sujeto</td>
<td><a href="#recipient">recipient</a> object</td>
<td>Information about the recipient.</td>
</tr>
<tr>
<td>tipo_emision</td>
<td>integer</td>
<td>Issuance mode. Normal: <code class="prettyprint">1</code>.<br>Contingency: <code class="prettyprint">2</code><br></td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>Version of the country e-billing format. Valid values: <code class="prettyprint">1.0.0</code>, <code class="prettyprint">1.1.0</code></td>
</tr>
</tbody></table>
